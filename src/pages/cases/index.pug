extends ../../layout.pug

mixin case-thumbnail(key, tech, name, desc, background, video, backgroundStyle="")
    a.case-thumbnail(href=("/case-" + key), style=(backgroundStyle ? ("background: " + backgroundStyle) : ""))
        +img(background, 612, 408)
        video(playsinline autoplay muted loop)
            source(-data-src=assetUrl(video), type="video/mp4")
        .case-thumbnail__content
            h6!= tech
            h2!= name
            p!= desc
            +cta-arrow("", "Смотреть кейс", 'small')


block body
    +section('top')
        +top-bar([ 'sticky', 'padding' ], { currentPage: "/cases" })
    +section('cases full')
        h1= siteData('blocks.label_cases')
        - let casesData = siteData('cases');
        - let cases = [ 'autoscaners', 'Squadrille', 'launch', 'iCartool', 'Ирина Хакамада', 'odin' ].map(slug => casesData.find(x => x.slug === slug)).filter(Boolean);
        - casesData.forEach(x => cases.indexOf(x) === -1 && cases.push(x));

        .case-thumbnails
            each caseItem, caseItemIndex in cases
                +case-thumbnail(
                    caseItem.slug,
                    caseItem.tech,
                    caseItem.title,
                    caseItem.lead,
                    caseItem.cover,
                    caseItem.cover_video
                )
    +feedback-form([ 'section' ])
    +footer